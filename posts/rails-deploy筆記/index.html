<!DOCTYPE html><html lang="Zh-TW" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-proxy-endpoint" content=" https://wells-blog.appspot.com/query?id=agxufndlbGxzLWJsb2dyFQsSCEFwaVF1ZXJ5GICAgOjXh4EJDA"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Rails Deploy 筆記" /><meta property="og:locale" content="Zh_TW" /><meta name="description" content="我是wells，擔任過室內配線的國手，征服了電氣領域後，現在正跨大版圖到資訊界。" /><meta property="og:description" content="我是wells，擔任過室內配線的國手，征服了電氣領域後，現在正跨大版圖到資訊界。" /><link rel="canonical" href="https://blog.wells.tw/posts/rails-deploy%E7%AD%86%E8%A8%98/" /><meta property="og:url" content="https://blog.wells.tw/posts/rails-deploy%E7%AD%86%E8%A8%98/" /><meta property="og:site_name" content="wells’s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-07-28T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Rails Deploy 筆記" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"datePublished":"2021-07-28T00:00:00+08:00","description":"我是wells，擔任過室內配線的國手，征服了電氣領域後，現在正跨大版圖到資訊界。","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.wells.tw/posts/rails-deploy%E7%AD%86%E8%A8%98/"},"url":"https://blog.wells.tw/posts/rails-deploy%E7%AD%86%E8%A8%98/","@type":"BlogPosting","headline":"Rails Deploy 筆記","dateModified":"2021-08-04T11:27:57+08:00","@context":"https://schema.org"}</script><title>Rails Deploy 筆記 | wells's blog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://wells-blog.r.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://wells-blog.r.appspot.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script async src="/assets/js/dist/pvreport.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-195452155-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-195452155-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/profile.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">wells's blog</a></div><div class="site-subtitle font-italic">當有人問我學過什麼<br>這裡就是我最好的回答</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/jhang-jhe-wei" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://www.facebook.com/profile.php?id=100006651004776" aria-label="Facebook" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-facebook-square"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['jhang0912407249','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Rails Deploy 筆記</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Rails Deploy 筆記</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> 張哲瑋 </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Jul 28, 2021, 12:00 AM +0800" prep="on" > Jul 28 <i class="unloaded">2021-07-28T00:00:00+08:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Aug 4, 2021, 11:27 AM +0800" prefix="Updated " > Aug 4 <i class="unloaded">2021-08-04T11:27:57+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1863 words">10 min</span> <span id="pv" class="pageviews"><i class="fas fa-spinner fa-spin fa-fw"></i></span></div></div><div class="post-content"><p>我是wells，擔任過室內配線的國手，征服了電氣領域後，現在正跨大版圖到資訊界。</p><h1 id="簡介">簡介</h1><p>近期 GCP 的免費額度快沒了，身為一位免費仔我決定再開一個帳號進行移機動作，但每次移機都會發現一些詭異的事情導致浪費一整天，故寫下這個筆記希望以後移機可以快一點。</p><h1 id="設定流程">設定流程</h1><ul><li><a href="#簡介"> 簡介</a><li><a href="#設定流程">設定流程</a><li><a href="#開始設定">開始設定</a><ul><li><a href="#設定-ssh">設定 SSH</a><li><a href="#安裝-rvm">安裝 RVM</a><li><a href="#安裝-ruby-on-rails">安裝 Ruby on Rails</a><li><a href="#安裝-nvm">安裝 NVM</a><li><a href="#安裝-nodejs-和-yarn">安裝 Nodejs 和 Yarn</a><li><a href="#安裝-database">安裝 Database</a><ul><li><a href="#mysql">MySQL</a><li><a href="#postgresql">PostgreSQL</a></ul><li><a href="#安裝-passenger--nginx">安裝 Passenger + Nginx</a><ul><li><a href="#確認安裝成功">確認安裝成功</a></ul><li><a href="#設定-passenger--nginx">設定 Passenger + Nginx</a><li><a href="#新增-ngork">新增 Ngork</a><li><a href="#bundle-lock-新增-linux-platform">Bundle lock 新增 Linux Platform</a><li><a href="#加入-capistrano-gem-至專案">加入 Capistrano Gem 至專案</a><li><a href="#設定-capistrano">設定 Capistrano</a><li><a href="#新增-databaseyml">新增 database.yml</a><li><a href="#新增-secretsyml">新增 secrets.yml</a><li><a href="#建立憑證">建立憑證</a><li><a href="#安裝-chromedriver">安裝 Chromedriver</a><li><a href="#常見狀況">常見狀況</a><ul><li><a href="#相同-domain-name-但-ssh-連不上">相同 Domain Name 但 SSH 連不上</a><li><a href="#假如-server-上的-rvm-找不到">假如 Server 上的 RVM 找不到</a></ul></ul></ul><h1 id="開始設定">開始設定</h1><h2 id="設定-ssh">設定 SSH</h2><p>請參考 <a href="../建立ssh連線到遠端伺服器/index.html">建立ssh連線到遠端伺服器</a>。</p><h2 id="安裝-rvm">安裝 RVM</h2><p>由於 <a href="https://rvm.io/">rvm</a> 在 Ubuntu 有專用的軟體包，以下指令為 <a href="https://github.com/rvm/ubuntu_rvm">此篇</a> 擷取：</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt-get <span class="nb">install </span>software-properties-common
<span class="nb">sudo </span>apt-add-repository <span class="nt">-y</span> ppa:rael-gc/rvm
<span class="nb">sudo </span>apt-get update
<span class="nb">sudo </span>apt-get <span class="nb">install </span>rvm
<span class="nb">sudo </span>usermod <span class="nt">-a</span> <span class="nt">-G</span> rvm <span class="nv">$USER</span>
</pre></table></code></div></div><blockquote><p>安裝完後記得把 RVM 加入環境變數，之後執行 <code class="language-plaintext highlighter-rouge">source /home/deploy/.bashrc</code>。</p></blockquote><h2 id="安裝-ruby-on-rails">安裝 Ruby on Rails</h2><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>rvm <span class="nb">install </span>2.7.2
gem <span class="nb">install </span>bundler
gem <span class="nb">install </span>rails <span class="nt">-v</span> 6.1.2
rails <span class="nt">--version</span>
</pre></table></code></div></div><h2 id="安裝-nvm">安裝 NVM</h2><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl <span class="nt">-o-</span> https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh | bash
</pre></table></code></div></div><blockquote><p>將 NVM 加入環境變數後，執行 <code class="language-plaintext highlighter-rouge">source /home/deploy/.bashrc</code>。</p></blockquote><h2 id="安裝-nodejs-和-yarn">安裝 Nodejs 和 Yarn</h2><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>nvm <span class="nb">install </span>node
npm <span class="nb">install</span> <span class="nt">-g</span> yarn
</pre></table></code></div></div><h2 id="安裝-database">安裝 Database</h2><h3 id="mysql">MySQL</h3><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt-get <span class="nb">install </span>mysql-common mysql-client libmysqlclient-dev mysql-server
mysql <span class="nt">-u</span> root <span class="nt">-p</span>
CREATE DATABASE databasename CHARACTER SET utf8mb4<span class="p">;</span>
</pre></table></code></div></div><blockquote><p>如果遇到 <code class="language-plaintext highlighter-rouge">ERROR 1698 (28000): Access denied for user 'root'@'localhost'</code> 參考 <a href="https://mustgeorge.blogspot.com/2011/11/mysql-error-1045-28000-using-password.html">此篇</a>。</p></blockquote><h3 id="postgresql">PostgreSQL</h3><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt-get <span class="nb">install </span>postgresql libpq-dev postgresql-contrib
<span class="nb">sudo</span> <span class="nt">-u</span> postgres psql
<span class="se">\p</span>assword
<span class="se">\q</span>uit
<span class="nb">sudo</span> <span class="nt">-u</span> postgres createdb demo-production
</pre></table></code></div></div><h2 id="安裝-passenger--nginx">安裝 Passenger + Nginx</h2><p>擷取 <a href="https://www.phusionpassenger.com/library/walkthroughs/deploy/ruby/ownserver/nginx/oss/xenial/install_passenger.html">此篇</a> 內容，執行以下指令：</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt-get <span class="nb">install </span>nginx

<span class="nb">sudo </span>apt-get <span class="nb">install</span> <span class="nt">-y</span> dirmngr gnupg
<span class="nb">sudo </span>apt-key adv <span class="nt">--keyserver</span> hkp://keyserver.ubuntu.com:80 <span class="nt">--recv-keys</span> 561F9B9CAC40B2F7
<span class="nb">sudo </span>apt-get <span class="nb">install</span> <span class="nt">-y</span> apt-transport-https ca-certificates

<span class="nb">sudo </span>sh <span class="nt">-c</span> <span class="s1">'echo deb https://oss-binaries.phusionpassenger.com/apt/passenger xenial main &gt; /etc/apt/sources.list.d/passenger.list'</span>
<span class="nb">sudo </span>apt-get update

<span class="nb">sudo </span>apt-get <span class="nb">install</span> <span class="nt">-y</span> nginx-extras passenger
</pre></table></code></div></div><blockquote><p>安裝完後重啟server <code class="language-plaintext highlighter-rouge">sudo service nginx restart</code></p></blockquote><h3 id="確認安裝成功">確認安裝成功</h3><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo</span> /usr/bin/passenger-config validate-install <span class="c">#選擇`Passenger itself`</span>
<span class="nb">sudo</span> /usr/sbin/passenger-memory-stats <span class="c"># 確認Nginx和Passenger有在運行</span>
</pre></table></code></div></div><h2 id="設定-passenger--nginx">設定 Passenger + Nginx</h2><p>編輯 <code class="language-plaintext highlighter-rouge">/etc/nginx/nginx.conf</code></p><div class="language-diff highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre>    # 讓 Nginx 可以讀到環境變量 PATH，Rails 需要這一行才能調用到 nodejs 來編譯靜態檔案
<span class="gi">+   env PATH;
</span>
    user www-data;
    worker_processes auto;
    pid /run/nginx.pid;

    events {
    worker_connections 768;
    # multi_accept on;
    }

http {

    # 關閉 Passenger 和 Nginx 在 HTTP Response Header 的版本資訊，減少資訊洩漏
<span class="gi">+   passenger_show_version_in_header off;
+   server_tokens       off;
</span>
    # 設定檔案上傳可以到100mb，默認只有1Mb超小氣的，上傳一張圖片就爆了
<span class="gi">+   client_max_body_size 100m;
</span>
    gzip on;
    gzip_disable "msie6";

    # 最佳化 gzip 壓縮
<span class="gi">+   gzip_comp_level    5;
+   gzip_min_length    256;
+   gzip_proxied       any;
+   gzip_vary          on;
+   gzip_types application/atom+xml application/javascript application/x-javascript application/json application/rss+xml application/vnd.ms-fontobject application/x-font-ttf application/x-web-app-manifest+json application/xhtml+xml application/xml font/opentype image/svg+xml image/x-icon text/css text/xml text/plain text/javascript text/x-component;
</span>
    # 打開 passenger 模組
<span class="gd">-   # include /etc/nginx/passenger.conf;
</span><span class="gi">+   include /etc/nginx/passenger.conf;
</span></pre></table></code></div></div><p>新增<code class="language-plaintext highlighter-rouge">/etc/nginx/sites-available/${project-name}</code>這個檔案，並填入以下內容：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>server {
    listen 80;
    server_name 1.2.3.4;   # 用你自己的服務器 IP 位置

    root /home/deploy/${project-name}/current/public; # 用你自己的項目名稱位置

    passenger_enabled on;

    passenger_min_instances 1;

    location ~ ^/assets/ {
        expires 1y;
        add_header Cache-Control public;
        add_header ETag "";
        break;
    }
}
</pre></table></code></div></div><p>執行以下指令：</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nb">cd</span> ../sites-enabled/
<span class="nb">sudo ln</span> <span class="nt">-s</span> ../sites-available/<span class="k">${</span><span class="nv">project</span><span class="p">-name</span><span class="k">}</span> <span class="nb">.</span>
service nginx restart
</pre></table></code></div></div><h2 id="新增-ngork">新增 Ngork</h2><p>新增 <code class="language-plaintext highlighter-rouge">etc/nginx/sites-available/ngrok</code>，填入以下內容：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>server {
  server_name ngrok.yourdomain.com;
  # 這邊設定你要設定的 url
  location / {
      proxy_pass http://localhost:3333/;
      proxy_set_header X-Real-IP $remote_addr;
      proxy_set_header Host $host;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Proto https; # 如果有設定 https 要加上這行
  }
}
</pre></table></code></div></div><p>執行以下指令：</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nb">cd</span> ../sites-enabled/
<span class="nb">sudo ln</span> <span class="nt">-s</span> ../sites-available/ngrok <span class="nb">.</span>
service nginx restart
</pre></table></code></div></div><h2 id="bundle-lock-新增-linux-platform">Bundle lock 新增 Linux Platform</h2><p>至專案中執行以下指令：</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>bundle lock <span class="nt">--add-platform</span> x86_64-linux
</pre></table></code></div></div><blockquote><p>執行完後要再推到 Repo</p></blockquote><h2 id="加入-capistrano-gem-至專案">加入 Capistrano Gem 至專案</h2><p>在 <code class="language-plaintext highlighter-rouge">Gemfile</code> 的 <code class="language-plaintext highlighter-rouge">development</code> 區塊中加入以下 Gem：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>gem "capistrano-rails"
gem "capistrano-passenger"
gem 'capistrano-rvm'
</pre></table></code></div></div><p>接著執行以下指令：</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>bundle <span class="nb">install
</span>cap <span class="nb">install</span>
</pre></table></code></div></div><h2 id="設定-capistrano">設定 Capistrano</h2><p>編輯 <code class="language-plaintext highlighter-rouge">Capfile</code>，加入以下內容</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>require 'capistrano/rails'
require 'capistrano/passenger'
require "capistrano/rvm"
</pre></table></code></div></div><p>編輯<code class="language-plaintext highlighter-rouge">config/deploy.rb</code></p><div class="language-diff highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre><td class="rouge-code"><pre><span class="gi">+  sh "ssh-add"
</span>
   # config valid only for current version of Capistrano
   lock "3.8.1"

-  set :application, "my_app_name"
<span class="gi">+  set :application, "demo"   # 請用你自己的項目名稱
</span>
-  set :repo_url, "git@example.com:me/my_repo.git"
<span class="gi">+  set :repo_url, "git@github.com:growthschool/rails-recipes.git"    # 請用你自己項目的git位置
</span>
+  set :rvm_custom_path, '/usr/share/rvm'  # only needed if not detected
   # Default branch is :master
   # ask :branch, `git rev-parse --abbrev-ref HEAD`.chomp

   # Default deploy_to directory is /var/www/my_app_name
   # set :deploy_to, "/var/www/my_app_name"
<span class="gi">+  set :deploy_to, "/home/deploy/demo"     # 這樣服務器上代碼的目錄位置，放在 deploy 帳號下。請用你自己的項目名稱。
</span>
   # Default value for :format is :airbrussh.
   # set :format, :airbrussh

   # You can configure the Airbrussh format using :format_options.
   # These are the defaults.
   # set :format_options, command_output: true, log_file: "log/capistrano.log", color: :auto, truncate: :auto

   # Default value for :pty is false
   # set :pty, true

   # Default value for :linked_files is []
<span class="gd">-  # append :linked_files, "config/database.yml", "config/secrets.yml"
</span><span class="gi">+  append :linked_files, "config/database.yml", "config/secrets.yml"
</span>
   # Default value for linked_dirs is []
<span class="gd">-  # append :linked_dirs, "log", "tmp/pids", "tmp/cache", "tmp/sockets", "public/system"
</span><span class="gi">+  append :linked_dirs, "log", "tmp/pids", "tmp/cache", "tmp/sockets", "public/system"
</span>
+  set :passenger_restart_with_touch, true

   # Default value for default_env is {}
   # set :default_env, { path: "/opt/ruby/bin:$PATH" }

   # Default value for keep_releases is 5
<span class="gd">-  # set :keep_releases, 5
</span><span class="gi">+  set :keep_releases, 5
</span></pre></table></code></div></div><p>編輯 <code class="language-plaintext highlighter-rouge">config/deploy/production.rb</code></p><div class="language-diff highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="gi">+   set :branch, "master"
</span><span class="gd">-   # server "example.com", user: "deploy", roles: %w{app db web}, my_property: :my_value
</span><span class="gi">+   server "demo.wells.tw", user: "deploy", roles: %w{app db web}, my_property: :my_value
</span></pre></table></code></div></div><p>設定完成後執行以下指令：</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cap production deploy:check
</pre></table></code></div></div><p>因為還沒有新增 <code class="language-plaintext highlighter-rouge">database.yml</code> 所以會報錯。</p><h2 id="新增-databaseyml">新增 database.yml</h2><p>在 <code class="language-plaintext highlighter-rouge">/home/deploy/demo/shared/config</code> 中新增 <code class="language-plaintext highlighter-rouge">database.yml</code>，如果使用 PostgreSQL 填入以下內容：</p><div class="language-yml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="na">default</span><span class="pi">:</span> <span class="nl">&amp;default</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">postgresql</span>
  <span class="na">encoding</span><span class="pi">:</span> <span class="s">unicode</span>
  <span class="na">pool</span><span class="pi">:</span> <span class="m">25</span>
  <span class="na">host</span><span class="pi">:</span> <span class="s">localhost</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s">postgres</span>
  <span class="na">password</span><span class="pi">:</span> <span class="s">password</span>
  
<span class="na">production</span><span class="pi">:</span>
  <span class="s">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*default</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">demo-production</span>
</pre></table></code></div></div><h2 id="新增-secretsyml">新增 secrets.yml</h2><p>在本地專案執行：</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>rails secret
</pre></table></code></div></div><p>將產生的金鑰依照下方格式貼在 Server 的 <code class="language-plaintext highlighter-rouge">/home/deploy/demo/shared/config/secrets.yml</code>。</p><div class="language-yml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="na">production</span><span class="pi">:</span>
  <span class="na">secret_key_base</span><span class="pi">:</span> <span class="s">把剛剛的亂數key貼上來</span>
</pre></table></code></div></div><h2 id="建立憑證">建立憑證</h2><p>參考 <a href="https://blog.hellojcc.tw/setup-https-with-letsencrypt-on-nginx/">此篇</a> 擷取其中內容，執行以下程式：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>sudo apt-get update
sudo apt-get install software-properties-common
sudo add-apt-repository ppa:certbot/certbot
sudo apt-get update
sudo apt-get install python-certbot-nginx
</pre></table></code></div></div><p>產生憑證指令：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sudo certbot --nginx -d hellojcc.tw -d www.hellojcc.tw
</pre></table></code></div></div><p>註銷憑證指令(有用到再執行)：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>certbot revoke --cert-path /etc/letsencrypt/archive/${YOUR_DOMAIN}/cert1.pem
</pre></table></code></div></div><h2 id="安裝-chromedriver">安裝 Chromedriver</h2><p>因為專案需要爬蟲，因此要裝 Chromedriver，執行以下指令：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>apt install chromium-chromedriver
</pre></table></code></div></div><h2 id="常見狀況">常見狀況</h2><h3 id="相同-domain-name-但-ssh-連不上">相同 Domain Name 但 SSH 連不上</h3><p>遇到類似以下錯誤訊息：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
github.com,52.69.186.44 ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAq2A7hRGmdnm9tUDbO9ID@       WARNING: POSSIBLE DNS SPOOFING DETECTED!          @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
The ECDSA host key for test.wells.tw has changed,
and the key for the corresponding IP address 34.81.121.249
is unchanged. This could either mean that
DNS SPOOFING is happening or the IP address for the host
and its host key have changed at the same time.
Offending key for IP in /Users/wells/.ssh/known_hosts:9
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!
Someone could be eavesdropping on you right now (man-in-the-middle attack)!
It is also possible that a host key has just been changed.
The fingerprint for the ECDSA key sent by the remote host is
SHA256:EC3r9M29PBWfOLIuF32Ha3meLK/wzu884s7/29tsxGs.
Please contact your system administrator.
Add correct host key in /Users/wells/.ssh/known_hosts to get rid of this message.
Offending ECDSA key in /Users/wells/.ssh/known_hosts:3
ECDSA host key for test.wells.tw has changed and you have requested strict checking.
Host key verification failed.
</pre></table></code></div></div><p>至本地開啟 <code class="language-plaintext highlighter-rouge">known_hosts</code>，並刪除有問題的 Domain</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>vim  ~/.ssh/known_hosts
</pre></table></code></div></div><h3 id="假如-server-上的-rvm-找不到">假如 Server 上的 RVM 找不到</h3><p>參考 <a href="https://github.com/capistrano/rvm">Capistrano 官方文件</a>，在本地的<code class="language-plaintext highlighter-rouge">config/deploy.rb</code>新增以下內容：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>set :rvm_custom_path, '/usr/share/rvm'  # only needed if not detected
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/note/'>Note</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/rails/" class="post-tag no-text-decoration" >Rails</a> <a href="/tags/gcp/" class="post-tag no-text-decoration" >GCP</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Rails Deploy 筆記 - wells's blog&url=https://blog.wells.tw/posts/rails-deploy%E7%AD%86%E8%A8%98/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Rails Deploy 筆記 - wells's blog&u=https://blog.wells.tw/posts/rails-deploy%E7%AD%86%E8%A8%98/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Rails Deploy 筆記 - wells's blog&url=https://blog.wells.tw/posts/rails-deploy%E7%AD%86%E8%A8%98/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/JAVA%E5%AF%A6%E4%BD%9C%E6%98%9F%E9%9A%9B%E5%A4%A7%E6%88%B0/">JAVA 實作星際大戰</a><li><a href="/posts/C++%E5%AF%A6%E4%BD%9C%E4%B8%AD%E5%9C%8B%E8%B1%A1%E6%A3%8B/">C++ 實作中國象棋</a><li><a href="/posts/C++%E5%AF%A6%E4%BD%9C%E5%A4%A7%E5%AF%8C%E7%BF%81/">C++ 實作大富翁</a><li><a href="/posts/x86%E7%B5%84%E8%AA%9E%E5%AF%A6%E4%BD%9C%E6%A4%8D%E7%89%A9%E5%A4%A7%E6%88%B0%E6%AE%AD%E5%B1%8D/">x86 組合語言實作植物大戰殭屍</a><li><a href="/posts/Ruby%E6%90%AD%E9%85%8DSketchup%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98%E5%9B%9B/">Ruby 搭配 Sketchup 學習筆記(四)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ruby/">Ruby</a> <a class="post-tag" href="/tags/sketchup/">Sketchup</a> <a class="post-tag" href="/tags/rails/">Rails</a> <a class="post-tag" href="/tags/final-project/">Final Project</a> <a class="post-tag" href="/tags/stm32/">STM32</a> <a class="post-tag" href="/tags/jekyll/">Jekyll</a> <a class="post-tag" href="/tags/ai/">AI</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/electrical-installations/">Electrical-Installations</a> <a class="post-tag" href="/tags/gcp/">GCP</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/%E4%BD%BF%E7%94%A8GoogleCloudDNS%E8%A8%AD%E5%AE%9ADNS/"><div class="card-body"> <span class="timeago small" > May 31 <i class="unloaded">2021-05-31T09:15:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>使用 Google Cloud DNS 設定域名</h3><div class="text-muted small"><p> 我是wells，擔任過室內配線的國手，征服了電氣領域後，現在正跨大版圖到資訊界。 料理食材(內文內容) 簡介 DNS設定流程 誰可以安心食用(適合誰讀) 有閒錢 已經有外部 IP 但還沒有域名 服用完你會獲得什麼 知道如何亂花錢 知道如何設定 GCP Cloud DNS 知道如何把域名連到你的 IP 簡介 設定域名是部署專案的起手式，在使用雲端...</p></div></div></a></div><div class="card"> <a href="/posts/Kamigo-%E6%90%AD%E9%85%8D-Devise-%E5%AF%A6%E4%BD%9C%E6%9C%83%E5%93%A1%E5%8A%9F%E8%83%BD/"><div class="card-body"> <span class="timeago small" > Jul 11 <i class="unloaded">2021-07-11T09:50:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Kamigo 搭配 Devise 實作會員功能</h3><div class="text-muted small"><p> 我是wells，擔任過室內配線的國手，征服了電氣領域後，現在正跨大版圖到資訊界。 簡介 前陣子在做實作台科不分系學姊時，發現需要會員機制，但假如直接開一個表單要使用者註冊似乎又有點太麻煩， 因為最終傳到 Server 的每一條訊息都已經帶有使用者資訊，於是和卡米哥討論該怎麼做，沒想到他早就已經做過了，而且還結合了 Devise，十分的方便，真是偉哉偉哉卡米哥。 前提提要 此篇文的前提是使用...</p></div></div></a></div><div class="card"> <a href="/posts/rails-%E5%AF%A6%E4%BD%9Csql-injection/"><div class="card-body"> <span class="timeago small" > Jul 19 <i class="unloaded">2021-07-19T09:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Rails 實作 SQL Injection</h3><div class="text-muted small"><p> 我是wells，擔任過室內配線的國手，征服了電氣領域後，現在正跨大版圖到資訊界。 本篇內容 介紹 入侵實作 修補方式 介紹 SQL(結構化查詢語言)用於管理資料庫，由於其無法區分值和控制指令， 因此惡意人士可以藉由在值中安插控制指令從而對資料庫進行惡意操作，這種操作稱為 SQL Injection。 入侵實作 本範例使用 Ruby on Rails 6 進行實作。 1...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/rails-%E6%90%AD%E9%85%8D-omniauth-line/" class="btn btn-outline-primary" prompt="Older"><p>Rails 搭配 Omniauth line</p></a> <a href="/posts/%E8%A7%A3%E6%B1%BA-github-deploy-key-%E5%95%8F%E9%A1%8C/" class="btn btn-outline-primary" prompt="Newer"><p>解決 Github Deploy Key is already in use 問題</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://www.facebook.com/profile.php?id=100006651004776">張哲瑋</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ruby/">Ruby</a> <a class="post-tag" href="/tags/sketchup/">Sketchup</a> <a class="post-tag" href="/tags/rails/">Rails</a> <a class="post-tag" href="/tags/final-project/">Final Project</a> <a class="post-tag" href="/tags/stm32/">STM32</a> <a class="post-tag" href="/tags/jekyll/">Jekyll</a> <a class="post-tag" href="/tags/ai/">AI</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/electrical-installations/">Electrical Installations</a> <a class="post-tag" href="/tags/gcp/">GCP</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://blog.wells.tw{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
